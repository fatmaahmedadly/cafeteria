(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[68069],{268536:(e,t,i)=>{i.d(t,{Z:()=>m});var n=i(27255),r=i(124580),s=i(172071),o=i(115535),a=i(402039),d=i(638525),u=i(12610),c=i(305689);function l(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const p=(0,c.ZP)();let h=null;class _{static getInstance(){return h||(h=new _),h}constructor(){l(this,"_logTimeoutLong",null),l(this,"_logTimeoutShort",null),l(this,"_moduleViewElements",{}),l(this,"_scrollListeners",{}),l(this,"_clickthroughStartEvent",null),l(this,"_utcDate",new Date);const e=(e,t)=>{const{activeElement:i}=document;i&&i.id===n.Z.VIDEO_IFRAME_ID&&i?setTimeout((()=>i.blur()),0):(r.Z.pause(u.LU),this.flushEvents(e,void 0))},t=(e=>{let t=!1;return(...i)=>{t||(t=!0,e(...i))}})((t=>e(!0)));window.addEventListener("beforeunload",t),window.addEventListener("pagehide",t),window.addEventListener("focus",(()=>{r.Z.resume(u.LU)})),window.addEventListener("blur",(t=>e(!1)))}_handleDatelineCrossover(){const e=new Date;this._utcDate.getUTCDate()!==e.getUTCDate()&&(this._utcDate=e,(0,o.Z)())}setTimeoutToFlushEvents(e){const t=e.event_type;if(_.EVENTS_FAST_FLUSH.includes(e.view_type)&&!this._logTimeoutShort&&13===t)this._logTimeoutShort=a.Z.setTimeout(this.flushEvents.bind(this,!1,!0),_.FLUSH_INTERVAL_SHORT);else if(!this._logTimeoutLong){const e=_.FLUSH_INTERVAL_LONG;this._logTimeoutLong=a.Z.setTimeout(this.flushEvents.bind(this),e)}}addEvent(e){const t=e.event_type;if(null==t)return;if(!(0,c.cA)(e))return;this.setTimeoutToFlushEvents(e);const i=(0,c.li)(e),n=c.Ch[t];n?(0,c.nc)(i,n).forEach(p.logImpression):(s.Z.increment("webapp.contextLogger.impressionType",.01,{event_type:t}),p.logContextEvent(i),this._handleDatelineCrossover(),12===t&&(p.logContextEvent({...i,event_type:7946}),this._clickthroughStartEvent={...i,time:1e6*Date.now()},d.Z.storeClickthroughProperties({view_type:i.view_type,view_parameter:i.view_parameter,component:i.component,element:i.element,object_id_str:i.object_id_str,view_data:i.view_data,aux_data:i.aux_data,clientTrackingParams:i.clientTrackingParams})))}flushEvents(e,t){var i;const n=null===(i=p.getContextEvents)||void 0===i?void 0:i.call(p);n&&!n.length||(this._handleDatelineCrossover(),p.flushContextEvents(e),t?this._resetShortTimerEvents():this._reset())}_reset(){this._resetShortTimerEvents(),this._resetLongTimerEvents()}_resetShortTimerEvents(){var e;null===(e=p.resetEventsBuffer)||void 0===e||e.call(p),clearTimeout(this._logTimeoutShort),this._logTimeoutShort=null}_resetLongTimerEvents(){var e;null===(e=p.resetEventsBuffer)||void 0===e||e.call(p),clearTimeout(this._logTimeoutLong),this._logTimeoutLong=null}logPlainObject(e){"event_type"in e&&this.addEvent({...e,..."aux_data"in e?{aux_data:{...e.aux_data}}:null})}}l(_,"FLUSH_INTERVAL_LONG",1e4),l(_,"FLUSH_INTERVAL_SHORT",300),l(_,"EVENTS_FAST_FLUSH",[9,3]),window.addEventListener&&window.addEventListener("focus",(()=>{const e=_.getInstance();if(e._clickthroughStartEvent){const t=e._clickthroughStartEvent;e._clickthroughStartEvent=null;const i={...t,event_type:4100,duration_ns:(0,c.h1)()-t.time};e.addEvent(i)}}));const m=_},638525:(e,t,i)=>{i.d(t,{Z:()=>c});var n=i(268536),r=i(768559),s=i(704115),o=i(927955),a=i(433780);const d={},u=(0,s.Z)()&&(0,s.Z)().debug_timespent,c=(0,a.Z)({flushEvents:e=>{n.Z.getInstance().flushEvents(e,void 0)},shouldShowLogStatements:u,track:(e,t)=>{const i=n.Z.getInstance(),s=o.Z.instance.getState();let a;if(s.pins&&e){const{pair_id:i,event_type:n}=e;if(4703===n&&i&&d[i])e.clientTrackingParams=d[i];else{var u;const o=e.object_id_str,c=o?s.pins[o]:null,l=null==t||null===(u=t.current)||void 0===u?void 0:u.location,p=null==t?void 0:t.previous;c&&l&&(a=(0,r.Z)(c,l,p)||`${c.tracking_params||""}~0`,e.clientTrackingParams=a,4702===n&&i&&(d[i]=a))}}i.addEvent(e)}})},115535:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(896625),r=i(635240),s=i(172071),o=i(6637),a=i(30287),d=i(305689),u=i(172045);const c=()=>1e6*Date.now();const l=function(){if(!n.Z.instance.is_authenticated)return;const e=window.location.pathname.startsWith("/pin/create/"),t="/pin-builder/"===window.location.pathname&&/url=/.test(window.location.href);if(!(e||t)&&!window.location.pathname.startsWith("/email/subscription")){var i;const{view_type:e,view_parameter:t}=(0,d.cv)(),l=(0,a.FB)(window),p={data:{browser:n.Z.instance.browser_type,clientUUID:(0,u.Z)(),event_type:7137,time:c,view_type:e,view_parameter:t,unauth_id:n.Z.instance.unauth_id,appVersion:(0,r.Z)(),auxData:{pwa_type:l&&"unknown"!==l?l:void 0,stage:null!==(i=n.Z.instance&&n.Z.instance.stage)&&void 0!==i?i:"unknown"}}},h=o.ZP.create("ActiveUserResource",p);let _=3e4;h.callCreate().catch((e=>{let t=e.message;if(t&&"object"==typeof t){t._t_message&&delete t._t_message;try{t=JSON.stringify(t)}catch(i){t="Unable to serialize error message"}}s.Z.increment("webapp.metrics.dau.errors",1,{message:t,browser:n.Z.instance.browser_type,error_code:e.api_error_code,is_auth:n.Z.instance.is_authenticated}),setTimeout((()=>{_>36e5||(_*=2,h.callCreate())}),_)}))}}},927955:(e,t,i)=>{i.d(t,{Z:()=>n});const n=new class{get instance(){return this.__storeInstance__}set instance(e){return this.__storeInstance__=e,e}set(e){return this.instance=e,e}}},433780:(e,t,i)=>{i.d(t,{Z:()=>u});var n=i(172071),r=i(245474);function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const o="ACTIVE",a="PAUSED",d=()=>window&&window.performance&&window.performance.now?`(Time: ${(window.performance.now()/1e3).toFixed(3)}s)`:"",u=({flushEvents:e,shouldShowLogStatements:t=!1,track:i})=>{const u=new Map,c=t?console:{error:(...e)=>{},log:(...e)=>{},group:(...e)=>{},groupEnd:(...e)=>{}};console.group||(c.group=(...e)=>console.log(...e),c.groupEnd=(...e)=>{});return new class{constructor(){s(this,"appTimedPair",null),s(this,"clickthroughProperties",null),s(this,"historyStackContext",null),s(this,"offsiteTimedPair",null),s(this,"offsiteTimedPairForegroundId",null),s(this,"addEventListeners",(()=>{let e,t;"undefined"!==document.hidden?(e="hidden",t="visibilitychange"):"undefined"!==document.msHidden?(e="msHidden",t="msvisibilitychange"):"undefined"!==document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange");const i=t=>{document[e]?this.unregisterApp(!1,void 0,t):document.hasFocus()&&this.registerApp()};t&&document.addEventListener(t,i,!1),window.addEventListener("focus",this.registerApp),window.addEventListener("blur",(e=>this.unregisterApp(!1,void 0,e)));const r=(e=>{let t=!1;return(...i)=>{t||(t=!0,e(...i))}})((e=>this.unregisterApp(!0,void 0,e)));window.addEventListener("beforeunload",r),window.addEventListener("pagehide",r);const s=navigator&&navigator.userAgent.toLowerCase();s&&s.includes("macintosh")&&s.includes("chrome")&&window.addEventListener("popstate",(t=>{document.hasFocus()||document[e]||n.Z.increment("chrome_mac_back_forward_button",1)}))})),s(this,"storeClickthroughProperties",(e=>{this.clickthroughProperties&&n.Z.increment("webapp.metrics.clickthroughs.overwritten",1,{previousView:this.clickthroughProperties.view_type,previousViewParameter:this.clickthroughProperties.view_parameter,nextView:e.view_type,nextViewParameter:e.view_parameter}),this.clickthroughProperties=e})),s(this,"clearClickthroughProperties",(()=>{this.clickthroughProperties=null,this.offsiteTimedPair=null,this.offsiteTimedPairForegroundId=null})),s(this,"registerApp",(()=>{c.group("App Foreground",d()),null==this.appTimedPair?(this.appTimedPair=new r.Z,this.appTimedPair.start(),this._unpauseAllComponents(),this._endOffsiteTimedPair(),null!==this.appTimedPair&&void 0!==this.appTimedPair&&i({event_type:4700,pair_id:this.appTimedPair.uuid},this.historyStackContext)):c.error("TimedPair already exists for app."),c.groupEnd()})),s(this,"unregisterApp",((t=!1,n=!1,r)=>{c.group("App Background",d());const s=this.appTimedPair;if(null!=s){this._pauseAllComponents();const e=s.end();this._startOffsiteTimedPair(),i({event_type:4701,duration_ns:e,pair_id:s.uuid},this.historyStackContext),this.appTimedPair=null}else c.error("No TimedPair found for app.");const o=["beforeunload","pagehide"],a=o.includes(null==r?void 0:r.type),u=o.includes(null==r?void 0:r.pauseReason);(a||u)&&this._endOffsiteTimedPair(),n||e(null!=t&&t,void 0,r),c.groupEnd()})),s(this,"_activateComponent",(e=>{c.group("Activating component",d()),t&&c.log(e.getContext());const n=e.getTimedPair();if(n){n.start();const{view:t,viewParameter:r,component:s,element:o,objectId:a,clientTrackingParams:d}=e.getLoggerContext();i({event_type:4702,view_type:t,view_parameter:r,component:s,element:o,object_id_str:a,view_data:e.props.viewData,pair_id:n.uuid,clientTrackingParams:d,aux_data:{time_spent_foreground_pairid:this.appTimedPair&&this.appTimedPair.uuid,time_spent_parent_pairid:e.getParentId(),...e.props.auxData}},this.historyStackContext)}c.groupEnd()})),s(this,"_deactivateComponent",(e=>{c.group("Deactivating component",d()),t&&c.log(e.getContext());const n=e.getTimedPair();if(n){const{view:t,viewParameter:r,component:s,element:o,objectId:a,clientTrackingParams:d}=n,u=n.end();i({event_type:4703,view_type:t,view_parameter:r,component:s,element:o,object_id_str:a,view_data:e.props.viewData,duration_ns:u,pair_id:n.uuid,clientTrackingParams:d,aux_data:{time_spent_foreground_pairid:this.appTimedPair&&this.appTimedPair.uuid,time_spent_parent_pairid:e.getParentId(),...e.props.auxData}},this.historyStackContext)}c.groupEnd()})),s(this,"_startOffsiteTimedPair",(()=>{const{clickthroughProperties:e}=this;e&&(this.offsiteTimedPair=new r.Z({...e,view:186,viewParameter:e.view_parameter,objectId:e.object_id_str}),this.offsiteTimedPair.start(),this.offsiteTimedPairForegroundId=this.appTimedPair?this.appTimedPair.uuid:null,i({...e,event_type:4702,view_type:186,pair_id:this.offsiteTimedPair?this.offsiteTimedPair.uuid:null,aux_data:{...e.aux_data,time_spent_foreground_pairid:this.offsiteTimedPairForegroundId}},this.historyStackContext))})),s(this,"_endOffsiteTimedPair",(()=>{const{offsiteTimedPair:e,clickthroughProperties:t}=this;if(e&&t){const n=e.end();i({...t,event_type:4703,view_type:186,pair_id:this.offsiteTimedPair?this.offsiteTimedPair.uuid:null,aux_data:{...t.aux_data,time_spent_foreground_pairid:this.offsiteTimedPairForegroundId},duration_ns:n},this.historyStackContext),this.clearClickthroughProperties()}})),s(this,"_pauseAllComponents",(()=>{c.group("Pause all components"),u.forEach(((e,t,i)=>{e===o&&this._deactivateComponent(t),i.set(t,a)})),c.groupEnd()})),s(this,"_unpauseAllComponents",(()=>{c.group("Unpause all components"),u.forEach(((e,t)=>{t.setTimedPair(new r.Z(t.getLoggerContext()))})),u.forEach(((e,t)=>{u.set(t,o),this._activateComponent(t)})),c.groupEnd()}))}setHistoryStackContext(e){this.historyStackContext=e}registerComponent(e){null===this.appTimedPair?u.set(e,a):(u.set(e,o),this._activateComponent(e))}unregisterComponent(e){u.get(e)===o&&(this._deactivateComponent(e),e.setTimedPair(new r.Z(e.getLoggerContext()))),u.delete(e)}size(){return u.size}}}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/68069-5eae1ef3e05dd060.mjs.map